- hosts: workers
  tasks:
          - #name: Install java
            #become: yes
            #yum:
            #    name: default-jre
            #    state: present
          - name: Copy spark tar to workers
            copy: src=/home/hadoop/spark-3.2.1-bin-hadoop3.2.tgz dest=/home/hadoop/
                #- name: Copy graphframes to workers
                #copy: src=/home/ubuntu/graphframes1.zip dest=/home/ubuntu/
          - #name: Copy graphframes jar to workers
            #copy: src=/home/ubuntu/spark-3.1.2-bin-hadoop3.2/jars/graphframes-0.8.1-spark3.0-s_2.12.jar dest=/home/ubuntu/spark-3.1.2-bin-hadoop3.2/jars/
            #- name: Copy input vertex list to workers
            #copy: src=/home/ubuntu/vertices.csv dest=/home/ubuntu/
          - #name: Copy input edge set to workers
            #copy: src=/home/ubuntu/edges.csv dest=/home/ubuntu/
          - name: Unzip tar
            ansible.builtin.unarchive:
                src: /home/hadoop/spark-3.2.1-bin-hadoop3.2.tgz 
                creates: /home/hadoop/spark-3.2.1-bin-hadoop3.2 
                dest: /home/hadoop/
          - name: Run spark daemon on workers
            command: ./start-worker.sh spark://ip-172-31-94-126.ec2.internal:7077
            args:
                  chdir: /home/hadoop/spark-3.2.1-bin-hadoop3.2/sbin/

